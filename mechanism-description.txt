Our implementation for our shard tolerant key value store includes:
Dictionary's to hold the key and values for each shard,  A list of replicas for nodes, a function for rebalancing the nodes into the shards, and a shard list.
For detecting if a replica is down we try to first detect down replicas by cycling through the replicas and seeing if there is a response. If there is not a response then we add it to the crashed replicas list. Then for each operation we ping the other replicas to see if the list of crashed replicas changed and edits the list based off the results. 
